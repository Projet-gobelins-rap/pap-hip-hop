<template>
  <section class="desktopConnection">
    <div class="desktopConnection-container">
      <img
        class="desktopConnection-sticker"
        src="/images/sticker-connexion.png"
        alt=""
      />
      <div class="desktopConnection-text">
        Scanne le QR Code depuis ton tel pour le connecter Ã  ton ordi
      </div>
      <div class="desktopConnection-qr">
        <div class="desktopConnection-qr--code" ref="qrcode"></div>
        <svg
          class="desktopConnection-qr--stars"
          width="203"
          height="139"
          viewBox="0 0 203 139"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <mask id="path-1-inside-1_1299_1152" fill="white">
            <path
              d="M20.1257 80.7713C20.3426 80.1174 21.2557 80.0856 21.5178 80.7228L22.5135 83.1432C25.2226 89.7291 30.6736 94.8032 37.4362 97.0345L39.9422 97.8614C40.5977 98.0777 40.6298 98.993 39.991 99.2543L37.549 100.253C30.9588 102.95 25.8761 108.391 23.6342 115.149L22.8102 117.633C22.5933 118.287 21.6802 118.319 21.4181 117.681L20.4224 115.261C17.7133 108.675 12.2623 103.601 5.49965 101.37L2.99371 100.543C2.33818 100.327 2.30613 99.4112 2.94494 99.1499L5.38694 98.1507C11.9771 95.4544 17.0598 90.0133 19.3017 83.2551L20.1257 80.7713Z"
            />
          </mask>
          <path
            d="M20.1257 80.7713C20.3426 80.1174 21.2557 80.0856 21.5178 80.7228L22.5135 83.1432C25.2226 89.7291 30.6736 94.8032 37.4362 97.0345L39.9422 97.8614C40.5977 98.0777 40.6298 98.993 39.991 99.2543L37.549 100.253C30.9588 102.95 25.8761 108.391 23.6342 115.149L22.8102 117.633C22.5933 118.287 21.6802 118.319 21.4181 117.681L20.4224 115.261C17.7133 108.675 12.2623 103.601 5.49965 101.37L2.99371 100.543C2.33818 100.327 2.30613 99.4112 2.94494 99.1499L5.38694 98.1507C11.9771 95.4544 17.0598 90.0133 19.3017 83.2551L20.1257 80.7713Z"
            fill="#FEFEFE"
          />
          <path
            d="M2.99371 100.543L3.62006 98.6436L2.99371 100.543ZM2.94494 99.1499L3.70261 101.001L2.94494 99.1499ZM22.8102 117.633L20.9119 117.003L22.8102 117.633ZM21.4181 117.681L23.2677 116.921L21.4181 117.681ZM37.549 100.253L36.7913 98.4024L37.549 100.253ZM39.9422 97.8614L39.3158 99.7606L39.9422 97.8614ZM39.991 99.2543L39.2333 97.4033L39.991 99.2543ZM21.5178 80.7228L19.6682 81.4833L21.5178 80.7228ZM20.1257 80.7713L22.024 81.4013L20.1257 80.7713ZM19.6682 81.4833L20.6638 83.9038L24.3631 82.3827L23.3674 79.9622L19.6682 81.4833ZM36.8099 98.9338L39.3158 99.7606L40.5685 95.9621L38.0626 95.1353L36.8099 98.9338ZM39.2333 97.4033L36.7913 98.4024L38.3066 102.105L40.7486 101.105L39.2333 97.4033ZM21.7358 114.519L20.9119 117.003L24.7085 118.263L25.5325 115.779L21.7358 114.519ZM23.2677 116.921L22.272 114.5L18.5728 116.022L19.5685 118.442L23.2677 116.921ZM6.126 99.4704L3.62006 98.6436L2.36736 102.442L4.87329 103.269L6.126 99.4704ZM3.70261 101.001L6.14461 100.002L4.62927 96.2997L2.18727 97.2988L3.70261 101.001ZM21.2 83.8851L22.024 81.4013L18.2274 80.1413L17.4034 82.6251L21.2 83.8851ZM6.14461 100.002C13.275 97.0844 18.7743 91.1974 21.2 83.8851L17.4034 82.6251C15.3453 88.8293 10.6792 93.8243 4.62927 96.2997L6.14461 100.002ZM3.62006 98.6436C4.72942 99.0096 4.78365 100.559 3.70261 101.001L2.18727 97.2988C-0.171385 98.2638 -0.0530583 101.643 2.36736 102.442L3.62006 98.6436ZM22.272 114.5C19.3408 107.375 13.443 101.885 6.126 99.4704L4.87329 103.269C11.0816 105.317 16.0857 109.976 18.5728 116.022L22.272 114.5ZM20.9119 117.003C21.279 115.896 22.8241 115.843 23.2677 116.921L19.5685 118.442C20.5363 120.795 23.9076 120.677 24.7085 118.263L20.9119 117.003ZM36.7913 98.4024C29.6609 101.32 24.1615 107.207 21.7358 114.519L25.5325 115.779C27.5906 109.575 32.2567 104.58 38.3066 102.105L36.7913 98.4024ZM39.3158 99.7606C38.2065 99.3946 38.1522 97.8456 39.2333 97.4033L40.7486 101.105C43.1073 100.14 42.9889 96.7607 40.5685 95.9621L39.3158 99.7606ZM20.6638 83.9038C23.5951 91.0295 29.4929 96.5196 36.8099 98.9338L38.0626 95.1353C31.8543 93.0869 26.8502 88.4286 24.3631 82.3827L20.6638 83.9038ZM23.3674 79.9622C22.3996 77.6095 19.0283 77.7269 18.2274 80.1413L22.024 81.4013C21.6569 82.5079 20.1118 82.5617 19.6682 81.4833L23.3674 79.9622Z"
            fill="#151515"
            mask="url(#path-1-inside-1_1299_1152)"
          />
          <mask id="path-3-inside-2_1299_1152" fill="white">
            <path
              d="M27.3003 117.82C27.4397 117.4 28.0263 117.38 28.1947 117.789C29.9353 122.02 33.4446 125.283 37.7896 126.716C38.2112 126.855 38.2319 127.445 37.821 127.613C33.5869 129.346 30.3143 132.844 28.8739 137.186C28.7346 137.606 28.1479 137.627 27.9795 137.218C26.2389 132.986 22.7296 129.724 18.3847 128.29C17.963 128.151 17.9424 127.561 18.3533 127.393C22.5874 125.661 25.8599 122.162 27.3003 117.82Z"
            />
          </mask>
          <path
            d="M27.3003 117.82C27.4397 117.4 28.0263 117.38 28.1947 117.789C29.9353 122.02 33.4446 125.283 37.7896 126.716C38.2112 126.855 38.2319 127.445 37.821 127.613C33.5869 129.346 30.3143 132.844 28.8739 137.186C28.7346 137.606 28.1479 137.627 27.9795 137.218C26.2389 132.986 22.7296 129.724 18.3847 128.29C17.963 128.151 17.9424 127.561 18.3533 127.393C22.5874 125.661 25.8599 122.162 27.3003 117.82Z"
            fill="#FEFEFE"
          />
          <path
            d="M19.1109 129.244C23.8843 127.291 27.5741 123.347 29.1986 118.45L25.402 117.19C24.1457 120.977 21.2904 124.03 17.5956 125.542L19.1109 129.244ZM19.011 126.391C20.3542 126.834 20.4199 128.709 19.1109 129.244L17.5956 125.542C15.4648 126.414 15.5718 129.468 17.7583 130.189L19.011 126.391ZM29.8291 136.457C27.8661 131.685 23.9094 128.007 19.011 126.391L17.7583 130.189C21.5499 131.44 24.6118 134.288 26.1299 137.978L29.8291 136.457ZM26.9756 136.556C27.4202 135.216 29.2918 135.151 29.8291 136.457L26.1299 137.978C27.004 140.103 30.0489 139.997 30.7722 137.816L26.9756 136.556ZM37.0633 125.762C32.2899 127.715 28.6001 131.659 26.9756 136.556L30.7722 137.816C32.0285 134.029 34.8838 130.976 38.5786 129.464L37.0633 125.762ZM37.1632 128.616C35.82 128.172 35.7544 126.298 37.0633 125.762L38.5786 129.464C40.7094 128.593 40.6025 125.538 38.4159 124.817L37.1632 128.616ZM26.3451 118.549C28.3082 123.322 32.2649 126.999 37.1632 128.616L38.4159 124.817C34.6243 123.566 31.5625 120.719 30.0443 117.028L26.3451 118.549ZM30.0443 117.028C29.1702 114.903 26.1254 115.009 25.402 117.19L29.1986 118.45C28.754 119.79 26.8824 119.856 26.3451 118.549L30.0443 117.028Z"
            fill="#151515"
            mask="url(#path-3-inside-2_1299_1152)"
          />
          <path
            d="M181.278 2.02807C181.444 1.64042 181.994 1.64042 182.16 2.02806L185.878 10.6938C185.981 10.9331 186.256 11.0469 186.498 10.9503L195.271 7.44476C195.663 7.28808 196.052 7.67759 195.895 8.06942L192.381 16.8146C192.284 17.0569 192.398 17.3325 192.638 17.435L201.323 21.1413C201.712 21.3072 201.712 21.8583 201.323 22.0242L192.638 25.7305C192.398 25.833 192.284 26.1086 192.381 26.3509L195.895 35.0961C196.052 35.4879 195.663 35.8774 195.271 35.7207L186.498 32.2152C186.256 32.1186 185.981 32.2324 185.878 32.4717L182.16 41.1374C181.994 41.5251 181.444 41.5251 181.278 41.1374L177.56 32.4717C177.457 32.2324 177.182 32.1186 176.941 32.2152L168.167 35.7207C167.775 35.8774 167.386 35.4879 167.544 35.0961L171.057 26.3509C171.154 26.1086 171.04 25.833 170.8 25.7305L162.115 22.0242C161.727 21.8583 161.727 21.3072 162.115 21.1413L170.8 17.435C171.04 17.3325 171.154 17.0569 171.057 16.8146L167.544 8.06942C167.386 7.67759 167.775 7.28808 168.167 7.44476L176.941 10.9503C177.182 11.0469 177.457 10.9331 177.56 10.6938L181.278 2.02807Z"
            fill="#FEFEFE"
            stroke="#151515"
            stroke-width="2"
          />
        </svg>
        <img
          class="desktopConnection-qr--sticker"
          src="/images/sticker-ici.png"
          alt=""
        />
      </div>
    </div>
  </section>
</template>

<script lang="ts">
import { Vue, Component, getModule } from "nuxt-property-decorator";
import globalStore from "~/store/globalStore";
import $socket from "~/plugins/socket.io";
import QRCode from "easyqrcodejs";
// import websocketManagerInstance from "~/core/managers/WebsocketManager"

@Component({
  components: {},
})
export default class Connection extends Vue {
  public home: string = "Home ðŸš§";
  public room: string = "0";

  public globalStore = getModule(globalStore, this.$store);

  mounted() {
    console.log(this.globalStore, "global store");
    console.log($socket.room);

    $socket.io.emit("server:join", $socket.room);
    $socket.io.on("server:joined", (id) => {
      // console.log("joined : " + id);
      this.room = id;
      this.generateQR();
    });

    // $socket.io.on("server:paired", (user) => {
    //   this.$router.push("/grenier");
    // });
  }

  // With async/await
  generateQR() {
    var options = {
      text: "https://192.168.1.12:3001/_mobile/connection/?room=" + this.room,
    };

    // Create new QRCode Object
    new QRCode(this.$refs.qrcode, options);
  }
}
</script>

<style lang="sass" scoped>
.home
  max-width: 700px
  margin: auto
  text-align: center
  .blog-avatar
    height: 140px
    width: 140px
    border-radius: 50%
    background-position: center
    background-size: cover
    margin: 1em auto
  .blog-description
    font-size: 18px
    color: #9A9A9A
    line-height: 30px
    margin-bottom: 3rem
    padding-bottom: 3rem
    font-family: 'Lato', sans-serif
    border-bottom: 1px solid #DADADA

.blog-main
  max-width: 700px
  margin: auto
  text-align: left
  &.single img
    width: 100%
    height: auto
  &.single a
    text-decoration: none
    background: -webkit-linear-gradient(top, rgba(0, 0, 0, 0) 75%, rgba(0, 0, 0, 0.8) 75%)
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0) 75%, rgba(0, 0, 0, 0.8) 75%)
    background-repeat: repeat-x
    background-size: 2px 2px
    background-position: 0 23px

.blog-post
  margin: 0
  margin-bottom: 3rem

@media (max-width: 767px)
  .home
    padding: 0 20px
  .blog-main
    padding: 0
    font-size: 18px
</style>
